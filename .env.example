# ==============================================
# Clockify Add-ons - Environment Configuration
# ==============================================
# Copy this file to .env and update values for your environment
#
# Development: Use SQLite databases (default)
# Production: Use PostgreSQL (recommended)

# ==============================================
# PostgreSQL Configuration (Production)
# ==============================================
POSTGRES_USER=clockify
POSTGRES_PASSWORD= # Generate strong password: openssl rand -base64 32
POSTGRES_DB=clockify

# ==============================================
# API Studio Configuration (Port 8000)
# ==============================================

## Database
# Development (SQLite): API_STUDIO_DB_URL=sqlite+aiosqlite:///./api_studio.db
# Production (PostgreSQL) - Update password before production use:
API_STUDIO_DB_URL=postgresql+asyncpg://clockify:${POSTGRES_PASSWORD}@postgres:5432/api_studio

## Core Settings
API_STUDIO_ADDON_KEY=clockify-api-studio
API_STUDIO_REQUIRE_SIGNATURE_VERIFICATION=true

## Bootstrap Settings
API_STUDIO_BOOTSTRAP_MAX_RPS=25
API_STUDIO_BOOTSTRAP_INCLUDE_HEAVY_ENDPOINTS=false

## Data Retention (days, 0 = disable cleanup)
API_STUDIO_WEBHOOK_LOG_RETENTION_DAYS=90
API_STUDIO_FLOW_EXECUTION_RETENTION_DAYS=30

# ==============================================
# Universal Webhook Configuration (Port 8001)
# ==============================================

## Database
# Development (SQLite): UNIVERSAL_WEBHOOK_DB_URL=sqlite+aiosqlite:///./universal_webhook.db
# Production (PostgreSQL) - Update password before production use:
UNIVERSAL_WEBHOOK_DB_URL=postgresql+asyncpg://clockify:${POSTGRES_PASSWORD}@postgres:5432/universal_webhook

## Core Settings
UNIVERSAL_WEBHOOK_PORT=8001
UNIVERSAL_WEBHOOK_ADDON_KEY=universal-webhook-api
UNIVERSAL_WEBHOOK_REQUIRE_SIGNATURE_VERIFICATION=true

## Bootstrap Settings
UW_BOOTSTRAP_MAX_RPS=25
UW_BOOTSTRAP_INCLUDE_HEAVY=false
UW_BOOTSTRAP_INCLUDE_TIME_ENTRIES=false
UW_BOOTSTRAP_TIME_ENTRY_DAYS=30
UW_BOOTSTRAP_MAX_PAGES=200

## Webhook Settings
UW_ENABLE_CUSTOM_WEBHOOKS=true
UW_WEBHOOK_LOG_RETENTION_DAYS=90

## Flow Settings
UW_ENABLE_FLOWS=true
UW_ENABLE_GENERIC_HTTP_ACTIONS=false
UW_FLOW_EXECUTION_RETENTION_DAYS=90

## Data Settings
UW_CACHE_TTL_DAYS=7

# ==============================================
# Clockify Add-on Configuration (Port 8002)
# ==============================================

## Database
# Development (SQLite): DATABASE_URL=sqlite+aiosqlite:///./clockify_addon.db
# Production (PostgreSQL) - Update password before production use:
DATABASE_URL=postgresql+asyncpg://clockify:${POSTGRES_PASSWORD}@postgres:5432/clockify_addon

## Server
CLOCKIFY_ADDON_BASE_URL=http://localhost:8002
DEBUG=false
REQUIRE_SIGNATURE_VERIFICATION=true

## Clockify API Endpoints
CLOCKIFY_API_BASE=https://api.clockify.me/api/v1
CLOCKIFY_DEVELOPER_API_BASE=https://developer.clockify.me/api/v1
CLOCKIFY_PTO_API_BASE=https://pto.api.clockify.me/v1
CLOCKIFY_REPORTS_API_BASE=https://reports.api.clockify.me/v1

## Rate Limiting
RATE_LIMIT_RPS=50
RATE_LIMIT_ENABLED=true

## Redis (optional, for distributed caching/rate limiting)
REDIS_URL=redis://localhost:6379/0
USE_REDIS=false

## Bootstrap
AUTO_BOOTSTRAP_ON_INSTALL=true
BOOTSTRAP_BATCH_SIZE=10
BOOTSTRAP_MAX_RETRIES=3
BOOTSTRAP_MAX_PAGES=1000

## Payload Limits (bytes)
API_CALL_MAX_PAYLOAD_BYTES=1048576
WEBHOOK_MAX_PAYLOAD_BYTES=5242880

## Webhook Retries
WEBHOOK_REQUEST_MAX_RETRIES=5
WEBHOOK_REQUEST_BACKOFF_BASE=0.5
WEBHOOK_REQUEST_BACKOFF_CAP=5.0

## Security (Optional)
# WEBHOOK_HMAC_SECRET=your-hmac-secret-here
# CLOCKIFY_JWKS_URL=https://api.clockify.me/.well-known/jwks.json
# CLOCKIFY_ENVIRONMENT=prod

# ==============================================
# Shared Configuration
# ==============================================
CLOCKIFY_API_BASE_URL=https://api.clockify.me
LOG_LEVEL=INFO

# ==============================================
# Production Deployment Notes
# ==============================================
# 1. Generate a strong POSTGRES_PASSWORD (use: openssl rand -base64 32)
# 2. Update all database URLs to use PostgreSQL (not SQLite)
# 3. Set REQUIRE_SIGNATURE_VERIFICATION=true for all services (required for Clockify traffic)
# 4. Set DEBUG=false for production
# 5. Configure reverse proxy (nginx) with SSL/TLS for public access
# 6. Set up log aggregation and monitoring (Prometheus metrics available at /metrics)
# 7. Enable automated backups for PostgreSQL
# 8. Review and adjust retention settings based on storage capacity
# 9. Firewall: Allow only necessary ports (443, 22) and block direct service access
# 10. Regular security updates and dependency scanning recommended
